## 项目概览

* 技术栈：HarmonyOS Stage 模式 + ArkUI + ArkTS/ETS，Hvigor 构建与 ohpm 包管理。

* 现状：应用入口已配置，首页 [Index.ets](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/entry/src/main/ets/pages/Index.ets) 仅展示“Hello World”。原型功能在独立的 Web 文件 [example.html](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/example.html) 中完整实现（SRS/SM-2、编辑、配对游戏、CSV 导入、朗读）。

* 目标：将原型的核心能力按鸿蒙原生方式落地，形成可用的记忆闪卡 App。

## 模块与入口

* 应用入口：[EntryAbility.ets](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/entry/src/main/ets/entryability/EntryAbility.ets) 在 onWindowStageCreate 中加载 pages/Index。

* 模块清单：[module.json5](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/entry/src/main/module.json5) 已注册备份扩展 EntryBackupAbility，页面声明于 [main\_pages.json](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/entry/src/main/resources/base/profile/main_pages.json)。

## 页面与导航

* 首页(Home)：卡组列表、待复习数量提示、入口按钮（智能复习/游戏挑战/编辑）。

* 编辑(Edit)：卡片增删改、CSV 导入、卡组基本信息管理。

* 学习(Study)：翻转卡片、SM-2 评分（Again/Hard/Good/Easy）与进度条。

* 配对游戏(Match)：正反面卡片配对、计时与通关反馈。

* 导航方案：ArkUI Navigation/Router 管理多页面栈；首页为入口，子页面返回至首页。

## 数据模型

* Deck：id、title、description、cards: Card\[]。

* Card：id、front、back、nextReview、interval、repetitions、easeFactor。

* 统计：会话统计（reviewCount、时长等），游戏统计（matchedPairs、gameTime）。

## 核心算法

* 迁移 [example.html](file:///Users/chenxiaoqiang/DevEcoStudioProjects/memorycard/example.html#L4-L45) 中 SM-2 实现为 ArkTS 工具函数（含边界保护与最小易记系数 1.3）。

* 学习流程：筛选到期卡片→按 nextReview 排序→评分更新→推进索引→会话完成提示。

## 数据持久化与备份

* 本地存储：优先使用偏好存储/文件存储保存 Deck/Card JSON；提供导入/导出接口。

* 备份恢复：对接 EntryBackupAbility，与资源 \[backup\_config.profile] 关联，实现数据备份与恢复（与存储层打通）。

## 原型功能映射到原生实现

* 待复习数量：按当前时间比较 nextReview 计算。

* 翻转卡片与评分：ArkUI 组件实现 FlipCard，评分四档映射到 SM-2。

* 配对游戏：生成两倍卡片（front/back），状态驱动动画与胜利判定。

* CSV 导入：调用系统文件选择器读取文本并解析为卡片（兼容引号、逗号）。

* 朗读：集成系统 TTS 能力（中英切换）；若暂不可用，提供占位与开关。

## 资源与界面

* 统一资源：strings/color/media 在 entry/resources/base 下维护。

* 交互风格：参考原型的卡片翻转、进度条、弹窗与提示文案，采用 ArkUI 组件实现。

## 测试与质量

* 单元测试：SM-2 算法、筛选排序与评分分支覆盖。

* 集成测试：页面跳转、编辑/导入/学习/游戏流程回归（ohosTest）。

* 性能与稳定：避免主线程阻塞；定时器在页面生命周期内安全清理。

## 迭代步骤

1. 建模与工具：定义 Deck/Card/算法工具与存储抽象。
2. 首页：渲染卡组与待复习数、导航到子页面。
3. 学习页：翻卡与评分、进度逻辑与持久化。
4. 编辑页：增删改、CSV 导入、持久化更新。
5. 配对游戏：卡片生成、计时器、胜利提示。
6. 朗读能力：集成或提供占位实现与开关。
7. 备份打通：接入 EntryBackupAbility 与数据层。
8. 测试完善：补齐单元/集成测试与资源优化。

## 需确认事项

* 本地数据存储首选方案（偏好/文件/自定义数据库）。

* TTS 朗读是否必须上线首版，或先占位。

* CSV 导入路径与交互（系统选择器或固定目录）。

